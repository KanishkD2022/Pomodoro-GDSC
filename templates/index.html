<!DOCTYPE html>
<html>
<head>
  <title>Pomodoro Timer</title>
  <style>
    body {
      font-family: Courier New, monospace;
    }
    h1 {
      text-align: center;
    }
    .center {
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    .timer-container {
      margin-top: 20px;
      text-align: center; /* Center the timer */
    }
    .timer-container button {
      margin-right: 10px;
    }
    .time-container {
      font-size: 24px; /* Increase the font size of the timer */
    }
    .task-container {
      margin-top: 20px;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 4px;
    }
    .task-container input[type="number"] {
      margin-bottom: 5px;
      width: 80px;
    }
    .task-history {
      margin-top: 20px;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 4px;
    }
    .progress-bar-container {
      width: 100%;
      height: 20px;
      background-color: #f3f3f3;
      margin: 20px auto;
      border-radius: 4px;
    }
    .progress-bar {
      height: 100%;
      background-color: #4caf50;
      border-radius: 4px;
      width: 0; /* Initially zero width */
    }
  </style>
</head>
<body>
  <h1>Pomodoro Timer</h1>
  <img src="static/banner.jpg" width="620" class="center" alt="Placeholder Image" />
  <div class="timer-container">
    <div class="time-container">
      <span id="minutes">0</span> : <span id="seconds">0</span>
    </div>
    <label for="work-time">Work Phase Timer (minutes):</label>
    <input type="number" id="work-time" min="1" step="1" value="25">
    <br>
    <label for="rest-time">Rest Phase Timer (minutes):</label>
    <input type="number" id="rest-time" min="1" step="1" value="5">
    <br>
    <button id="start-timer">START</button>
    <button id="reset-timer">RESET</button>
    <button id="stop-timer">STOP</button>
  </div>
  <div class="progress-bar-container">
    <div id="progress-bar" class="progress-bar"></div>
  </div>
  <div class="task-container">
    <h2>Tasks:</h2>
    <input type="text" id="taskInput" placeholder="Enter task...">
    <button id="add-task">Add Task</button>
    <ul id="taskList"></ul>
  </div>
  <div class="task-history">
    <h2>Task History:</h2>
    <ul id="completedTaskList"></ul>
  </div>
  <script>
    let timerInterval;
    let totalSeconds = 0;
    let isWorkPhase = true;
    const minutesDisplay = document.getElementById('minutes');
    const secondsDisplay = document.getElementById('seconds');
    const startTimerButton = document.getElementById('start-timer');
    const stopTimerButton = document.getElementById('stop-timer');
    const resetTimerButton = document.getElementById('reset-timer');
    const workTimeInput = document.getElementById('work-time');
    const restTimeInput = document.getElementById('rest-time');
    const taskInput = document.getElementById('taskInput');
    const addTaskButton = document.getElementById('add-task');
    const taskList = document.getElementById('taskList');
    const completedTaskList = document.getElementById('completedTaskList');
    const progressBar = document.getElementById('progress-bar');

    function startTimer(workDuration, restDuration) {
      totalSeconds = isWorkPhase ? workDuration * 60 : restDuration * 60;
      timerInterval = setInterval(updateTimer, 1000);
      workTimeInput.disabled = true;
      restTimeInput.disabled = true;
    }

    function stopTimer() {
      clearInterval(timerInterval);
      workTimeInput.disabled = false;
      restTimeInput.disabled = false;
    }

    function resetTimer() {
      clearInterval(timerInterval);
      totalSeconds = 0;
      updateTimerDisplay();
      workTimeInput.disabled = false;
      restTimeInput.disabled = false;
    }

    function updateTimer() {
      if (totalSeconds <= 0) {
        clearInterval(timerInterval);
        if (isWorkPhase) {
          showNotification('Work Phase Over', 'Time to take a rest!');
          isWorkPhase = false;
          startTimer(parseInt(restTimeInput.value), parseInt(workTimeInput.value));
        } else {
          showNotification('Rest Phase Over', 'Back to work!');
          isWorkPhase = true;
          startTimer(parseInt(workTimeInput.value), parseInt(restTimeInput.value));
        }
      } else {
        totalSeconds--;
        updateTimerDisplay();
        updateProgressBar();
      }
    }

    function updateTimerDisplay() {
      const minutes = Math.floor(totalSeconds / 60);
      const seconds = totalSeconds % 60;
      minutesDisplay.textContent = minutes;
      secondsDisplay.textContent = seconds < 10 ? '0' + seconds : seconds;
    }

    function updateProgressBar() {
      const progress = ((isWorkPhase ? parseInt(workTimeInput.value) : parseInt(restTimeInput.value)) * 60 - totalSeconds) / ((isWorkPhase ? parseInt(workTimeInput.value) : parseInt(restTimeInput.value)) * 60) * 100;
      progressBar.style.width = progress + '%';
    }

    function addTask() {
      const taskText = taskInput.value.trim();
      if (taskText !== '') {
        const li = document.createElement('li');
        li.textContent = taskText;
        const completeButton = document.createElement('button');
        completeButton.textContent = '✓';
        completeButton.classList.add('complete-task');
        li.appendChild(completeButton);

        // Add delete button only if it's a new task
        if (!li.querySelector('.delete-task')) {
          const deleteButton = document.createElement('button');
          deleteButton.textContent = 'Delete';
          deleteButton.classList.add('delete-task');
          li.appendChild(deleteButton);
        }

        taskList.appendChild(li);
        taskInput.value = '';
      }
    }

    function showNotification(title, body) {
      if ('Notification' in window && Notification.permission === 'granted') {
        new Notification(title, { body: body });
      } else if ('Notification' in window && Notification.permission !== 'denied') {
        Notification.requestPermission().then(function (permission) {
          if (permission === 'granted') {
            new Notification(title, { body: body });
          }
        });
      }
    }

    function completeTask(task) {
      if (!task.querySelector('.remove-task')) {
        const removeButton = document.createElement('button');
        removeButton.textContent = '✖';
        removeButton.classList.add('remove-task');
        task.appendChild(removeButton);
      }
      if (!task.querySelector('.delete-task')) {
        const deleteButton = document.createElement('button');
        deleteButton.textContent = 'Delete';
        deleteButton.classList.add('delete-task');
        task.appendChild(deleteButton);
      }

      const completeButton = task.querySelector('.complete-task');
      completeButton.disabled = true;
      task.style.textDecoration = 'line-through';
      taskList.removeChild(task);
      completedTaskList.appendChild(task);
    }

    function removeTask(task) {
      task.remove();
    }

    function replaceTask(task) {
      const completeButton = task.querySelector('.complete-task');
      if (completeButton) {
        completeButton.removeAttribute('disabled');
      }

      if (!task.querySelector('.delete-task')) {
        const deleteButton = document.createElement('button');
        deleteButton.textContent = 'Delete';
        deleteButton.classList.add('delete-task');
        task.appendChild(deleteButton);
      }

      task.style.textDecoration = 'none';
      completedTaskList.removeChild(task);
      taskList.appendChild(task);
    }

    addTaskButton.addEventListener('click', addTask);

    document.addEventListener('click', function(event) {
      if (event.target.classList.contains('complete-task')) {
        completeTask(event.target.parentNode);
      }
      if (event.target.classList.contains('delete-task')) {
        removeTask(event.target.parentNode);
      }
      if (event.target.classList.contains('remove-task')) {
        replaceTask(event.target.parentNode);
      }
    });

    startTimerButton.addEventListener('click', function() {
      startTimer(parseInt(workTimeInput.value), parseInt(restTimeInput.value));
    });
    stopTimerButton.addEventListener('click', stopTimer);
    resetTimerButton.addEventListener('click', resetTimer);
  </script>
</body>
</html>
